<div class="boutique-container">
  <div class="header">
    <h1>üè™ Gestion de la Boutique</h1>
  </div>

  <div class="error-message" *ngIf="error">
    {{ error }}
  </div>

  <div class="info-message" *ngIf="info">
    {{ info }}
  </div>

  <section class="dashboard-card">
    <h2>‚ûï Cr√©er une boutique</h2>

    <div class="form-row">
      <label>Nom</label>
      <input type="text" [(ngModel)]="newBoutiqueName" placeholder="Nom de la boutique" />
    </div>

    <div class="form-row">
      <label>Cat√©gorie</label>
      <select [(ngModel)]="newBoutiqueCategory">
        <option [ngValue]="null">Choisir...</option>
        <option *ngFor="let c of categories" [ngValue]="c">{{ c }}</option>
      </select>
    </div>

    <button class="action-btn" (click)="createBoutique()" [disabled]="creatingBoutique">
      {{ creatingBoutique ? 'Cr√©ation...' : 'Cr√©er' }}
    </button>
  </section>

  <section class="dashboard-card" style="margin-top: 20px;">
    <h2>üè™ Boutique active</h2>

    <div class="form-row">
      <label>S√©lection</label>
      <select [(ngModel)]="selectedBoutiqueId" (ngModelChange)="onSelectedBoutiqueChange()">
        <option [ngValue]="null">Choisir...</option>
        <option *ngFor="let b of boutiques" [ngValue]="b._id">{{ b.name }}</option>
      </select>
    </div>
  </section>

  <section class="dashboard-card" style="margin-top: 20px;">
    <h2>üìù Profil Boutique</h2>

    <div *ngIf="!selectedBoutiqueId" style="padding: 12px 0;">
      S√©lectionne une boutique pour modifier son profil.
    </div>

    <div class="form-row">
      <label>Nom</label>
      <input type="text" [(ngModel)]="profileName" placeholder="Nom de la boutique" />
    </div>

    <div class="form-row">
      <label>Cat√©gorie</label>
      <select [(ngModel)]="profileCategory">
        <option [ngValue]="null">Choisir...</option>
        <option *ngFor="let c of categories" [ngValue]="c">{{ c }}</option>
      </select>
    </div>

    <button class="action-btn" (click)="saveProfile()" [disabled]="savingProfile">
      {{ savingProfile ? 'Enregistrement...' : 'Enregistrer' }}
    </button>
  </section>

  <section class="dashboard-card" style="margin-top: 20px;" *ngIf="!loading">
    <h2>üì¶ Demande d'allocation de Box</h2>
    <p>S√©lectionne une box disponible puis envoie une demande. L'admin devra valider.</p>

    <div class="table-container">
      <table class="boxes-table">
        <thead>
          <tr>
            <th>Nom</th>
            <th>Num√©ro</th>
            <th>Loyer</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let box of availableBoxes">
            <td>{{ box.name }}</td>
            <td>{{ box.number }}</td>
            <td>{{ box.rent }}</td>
            <td>
              <button class="action-btn" (click)="requestBox(box)" [disabled]="isButtonDisabled(box)">
                {{ isRequesting(box._id) ? 'Demande...' : 'Demander' }}
              </button>
            </td>
          </tr>

          <tr *ngIf="availableBoxes.length === 0">
            <td colspan="4" style="text-align:center; padding: 16px;">Aucune box disponible</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Chargement...</p>
  </div>

</div>
